{% extends "area51/base.html" %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-3">
            <p class="fa fa-book"> OPEN EVENTS: {{ open_events }}</p>
            <p class="fa fa-archive"> ARCHIVED EVENTS: {{ dealt_events }}</p>
	    <hr>
        </div>
    <div class="col-md-offset-6">
	    <ul class="list-group">
                <li href="#" class="list-group-item" align="center">Event Categories</li>
		{% for cat in categories %}
                <li href="#" class="list-group-item">
                    <span href="#" class="cat-name" data-pk={{ cat.id }}><strong>{{ cat.name }}</strong></span>
                    <a href="/api/panel/categories/?pk={{ cat.id }}&name=delete">
                        <button type="button" class="btn btn-xs pull-right btn-danger">
                            <i class="fa fa-times"></i>
                        </button>
                    </a>
                </li>
		{% endfor %}
	    </ul>
            <form action="/api/panel/categories/" method="post" accept-charset="utf-8" class="form-horizontal" role="form">
                <label class="col-lg-3 control-label">New Category:</label>
                <div class="col-lg-6">
                    <input name="cat_name" class="form-control" type="text" placeholder="I SAW THE DEVIL">
                </div>
                <a class="col-lg-3">
                    <button type="submit" class="btn btn-xs pull-right btn-success">
                        <p><strong>Add</strong></p>
                    </button>
                </a>
            </form>
        </div>
    </div>
</div>
<br>
<div class="container">
    <div class="row">
        <div class="panel panel-default">
            <!-- Default panel contents -->
            <div class="panel-heading" align="center"><p><strong>USERS<p></strong></div>
            <table class="table table-striped table-bordered table-condensed">
                <tr>
                    <td>#</td>
                    <td><strong>Moderator</strong></td>
                    <td><strong>Deactivate</strong></td>
                    <td><strong>Username</strong></td>
                    <td><strong>First name</strong></td>
                    <td><strong>Last name</strong></td>
                    <td><strong>Events</strong></td>
                    <td><strong>Date Joined</strong></td>
                    <td><strong>Last login</strong></td>
                    <td><strong>Contact</strong></td>
                </tr>
                {% for us in users %}
                <tr>
                    <td>{{ us.id }}</td>
                    {% if us.is_superuser %}
                    <td align="center"><i class="fa fa-check"></i></td>
                    {% else %}
                    <td href="#" align="center">
                        <a align="right" href="/api/panel/?pk={{ us.id }}&name=is_superuser">
                            <button type="button" class="btn btn-xs btn-success">
                                <i class="fa fa-check"></i>
                            </button>
                        </a>
                    </td>
                    {% endif %}
                    {% if us.is_active %}
                    <td href="#" align="center">
                        <a align="right" href="/api/panel/?pk={{ us.id }}&name=is_active">
                            <button type="button" class="btn btn-xs btn-danger">
                                <i class="fa fa-times"></i>
                            </button>
                        </a>
                    </td>
                    {% else %}
                    <td href="#" align="center">
                        <a align="right" href="/api/panel/?pk={{ us.id }}&name=is_active">
                            <button type="button" class="btn btn-xs btn-success">
                                <i class="fa fa-check"></i>
                            </button>
                        </a>
                    </td>
                    {% endif %}
                    <td href="#" class="username" data-pk={{ us.id }}>{{ us.username }}</td>
                    <td href="#" class="first_name" data-pk={{ us.id }}>{{ us.first_name }}</td>
                    <td href="#" class="last_name" data-pk={{ us.id }}>{{ us.last_name }}</td>
                    <td class="dropdown">
                        <a href="#" data-toggle="dropdown" class="dropdown-toggle">User Events<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            {% for event in all_events %}
                                {% if event.creator == us %}
                                <li><a href="/e/{{ event.id }}/">{{ event.id }} {{ event.title }}
                                    {% if event.dealt %}
                                    <i class="fa fa-check"></i>
                                    {% else %}
                                    <i class="fa fa-times"></i>
                                    {% endif %}
                                </a></li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </td>
                    <td>{{ us.date_joined }}</td>
                    <td>{{ us.last_login }}</td>
                    <td>{{ us.email }}</td>
                </tr>
                {% endfor %}
                </tr>
            </table>
        </div>
    </div>
</div>

<script>
$(window).load(function() {
        $('.username').editable({
            type: 'text',
            name: 'username',
            url: '/api/panel/',
        });

        $('.first_name').editable({
            type: 'text',
            name: 'first_name',
            url: '/api/panel/',
        });

        $('.last_name').editable({
            type: 'text',
            name: 'last_name',
            url: '/api/panel/',
        });

        $('.cat-name').editable({
            type: 'text',
            name: 'yoyo',
            url: '/api/panel/categories/',
        });
});
</script>
{% endblock %}
